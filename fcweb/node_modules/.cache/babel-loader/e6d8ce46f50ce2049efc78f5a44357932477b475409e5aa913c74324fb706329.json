{"ast":null,"code":"import { createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/bk.png';\nconst _withScopeId = n => (_pushScopeId(\"data-v-656e44f7\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"space_background\"\n};\nconst _hoisted_2 = {\n  class: \"space-line-background\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, null, -1 /* HOISTED */));\nconst _hoisted_6 = {\n  class: \"time_container\"\n};\nconst _hoisted_7 = {\n  class: \"content_container\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"imgs_container\"\n};\nconst _hoisted_9 = [\"onClick\", \"src\"];\nconst _hoisted_10 = {\n  key: 1,\n  class: \"files_container\"\n};\nconst _hoisted_11 = {\n  class: \"like_container\"\n};\nconst _hoisted_12 = {\n  class: \"btn_container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_button = _resolveComponent(\"a-button\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode($setup[\"HomeOutlined\"], {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.jumphelper.jumpToSelect()),\n    class: \"home_icon\"\n  }), _createElementVNode(\"div\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.spaces, (space, spaceIndex) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: spaceIndex,\n      class: \"space_line\"\n    }, [_createCommentVNode(\"背景\"), _createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"img\", {\n      src: space.spaceImgs[0]\n    }, null, 8 /* PROPS */, _hoisted_4), _hoisted_5]), _createCommentVNode(\"时间\"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"h3\", null, _toDisplayString(space.spaceTime), 1 /* TEXT */)]), _createCommentVNode(\"内容\"), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"p\", null, _toDisplayString(space.spaceContent), 1 /* TEXT */), space.spaceImgs[0] !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(space.spaceImgs, (item, imgIndex) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: imgIndex\n      }, [_createElementVNode(\"img\", {\n        onClick: $event => $setup.showSpaceImg(item),\n        src: item,\n        alt: \"\"\n      }, null, 8 /* PROPS */, _hoisted_9)]);\n    }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), space.spaceFiles[0] !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(space.spaceFiles, (item, fileIndex) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: fileIndex\n      }, [_createVNode(_component_a_button, {\n        onClick: $event => $setup.downloadFile(spaceIndex, fileIndex)\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"点击下载文件 \" + _toDisplayString(fileIndex + 1), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]);\n    }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_11, [_createVNode($setup[\"LikeOutlined\"], {\n      class: \"like\",\n      onClick: $event => $setup.likeSpace(space.spaceId, spaceIndex)\n    }, null, 8 /* PROPS */, [\"onClick\"]), _createTextVNode(\" \" + _toDisplayString(space.likeNum), 1 /* TEXT */)])])]);\n  }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\"查看更多\"), _createElementVNode(\"div\", _hoisted_12, [_createVNode(_component_a_button, {\n    style: {\n      \"font-family\": \"夏风\"\n    },\n    type: \"text\",\n    onClick: $setup.getMore\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"- 查看更多 -\")]),\n    _: 1 /* STABLE */\n  })])]), _createVNode($setup[\"ImgCom\"])]);\n}","map":{"version":3,"names":["_imports_0","class","_createElementVNode","src","alt","key","_createElementBlock","_hoisted_1","_createVNode","$setup","onClick","_cache","$event","jumphelper","jumpToSelect","_Fragment","_renderList","spaces","space","spaceIndex","_createCommentVNode","_hoisted_2","_hoisted_3","spaceImgs","_hoisted_4","_hoisted_5","_hoisted_6","_toDisplayString","spaceTime","_hoisted_7","spaceContent","_hoisted_8","item","imgIndex","showSpaceImg","_hoisted_9","spaceFiles","_hoisted_10","fileIndex","_component_a_button","downloadFile","default","_withCtx","_createTextVNode","_","_hoisted_11","likeSpace","spaceId","likeNum","_hoisted_12","style","type","getMore"],"sources":["/Users/ayden/Desktop/FiveCheersBlog/fcweb/src/pages/myspace/DesktopMySpace.vue"],"sourcesContent":["<script setup>\nimport {\n  HomeOutlined, LikeOutlined,\n} from '@ant-design/icons-vue';\nimport {jumphelper} from \"@/js/jumphelper\";\nimport {onMounted, ref} from \"vue\";\nimport {likeSpaceApi, postLog, selectSpaceApi} from \"@/js/apihelper\";\nimport {timeCorrect} from \"@/js/jshelper\";\nimport {message} from \"ant-design-vue\";\nimport {bus} from \"vue3-eventbus\";\nimport ImgCom from \"@/coms/all/ImgCom.vue\";\nonMounted(()=>{\n  getSpace()\n  getLikedData()\n  message.info('欢迎访问我的空间:D')\n})\nconst currentParams = ref({\n  startIndex: 0,\n  length: 4,\n})\nconst spaces = ref([])\nconst getSpace = ()=>{\n  const getResult = selectSpaceApi(currentParams.value)\n  getResult.then(response=>{\n    for (const tmpSpace of response.data) {\n      tmpSpace.spaceTime = timeCorrect(tmpSpace.spaceTime)\n    }\n    if (response.data.length>0){\n      spaces.value = spaces.value.concat(response.data)\n    }else{\n      message.warn('后面没有了，更早的请看旧版于眉顶部“我的空间”')\n    }\n\n  }).catch(e=>{\n    console.log(e)\n    message.error('未知错误')\n  })\n}\nconst showSpaceImg = (imgUrl)=>{\n  bus.emit('showImg',imgUrl)\n}\nconst downloadFile = (spaceIndex, fileIndex)=>{\n  const fileUrl = spaces.value[spaceIndex].spaceFiles[fileIndex]\n  window.location.href = fileUrl\n}\nconst likeSpace = (spaceId, spaceIndex)=>{\n  if (beforeLike(spaceId)){\n    const postResult = likeSpaceApi(spaceId)\n    postResult.then(response=>{\n      if (response.data){\n        saveLikedData()\n        message.success('谢谢喜欢:D')\n        postLog('空间点赞，spaceId为'+spaceId)\n        spaces.value[spaceIndex].likeNum += 1\n      }else {\n        message.error('点赞失败')\n      }\n    }).catch(e=>{\n      message.error('未知错误')\n      console.log(e)\n    })\n  }else{\n    message.warn('每天只能给每条说说点10个赞')\n  }\n\n}\nconst getMore = ()=>{\n  currentParams.value.startIndex += currentParams.value.length;\n  getSpace()\n}\n\nconst likedData = ref([])\nconst getLikedData = ()=>{\n  if (localStorage.getItem('likedData')){\n    likedData.value = JSON.parse(localStorage.getItem('likedData'))\n  }else{\n    localStorage.setItem('likedData','[]')\n    likedData.value = JSON.parse(localStorage.getItem('likedData'))\n  }\n}\nconst saveLikedData = ()=>{\n  const likedDataString = JSON.stringify(likedData.value)\n  localStorage.setItem('likedData', likedDataString)\n}\nconst beforeLike = (spaceId)=>{\n  const filteredArray = likedData.value.filter(item => item.spaceId === spaceId);\n  console.log(filteredArray)\n  if (filteredArray.length>0){\n    for (const filteredArrayElement of filteredArray) {\n      if (filteredArrayElement.time === getNowTime() && filteredArrayElement.num >= 10){\n        return false\n      }else if (filteredArrayElement.time !== getNowTime()){\n        filteredArrayElement.time = getNowTime()\n        filteredArrayElement.num = 1\n        return true\n      }else{\n        filteredArrayElement.num += 1\n        return true\n      }\n    }\n  }else{\n    likedData.value.push({\n      spaceId: spaceId,\n      userId: localStorage.getItem('UUID'),\n      time: getNowTime(),\n      num: 1\n    })\n    return true\n  }\n  return false\n}\nconst getNowTime = ()=>{\n  const date = new Date()\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2,'0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const nowTime = `${year}-${month}-${day}`\n  return nowTime\n}\n\n\n</script>\n\n<template>\n  <div class=\"space_background\">\n    <HomeOutlined @click=\"jumphelper.jumpToSelect()\" class=\"home_icon\"/>\n    <div>\n      <div v-for=\"(space, spaceIndex) in spaces\" :key=\"spaceIndex\" class=\"space_line\">\n        <!--背景-->\n        <div class=\"space-line-background\">\n          <img src=\"@/assets/bk.png\" alt=\"\">\n          <img :src=\"space.spaceImgs[0]\">\n          <div></div>\n        </div>\n        <!--时间-->\n        <div class=\"time_container\">\n          <h3>{{ space.spaceTime }}</h3>\n        </div>\n        <!--内容-->\n        <div class=\"content_container\">\n          <p>{{ space.spaceContent }}</p>\n          <div v-if=\"space.spaceImgs[0] !== ''\" class=\"imgs_container\">\n            <div v-for=\"(item, imgIndex) in space.spaceImgs\" :key=\"imgIndex\">\n              <img @click=\"showSpaceImg(item)\" :src=\"item\" alt=\"\">\n            </div>\n          </div>\n          <div v-if=\"space.spaceFiles[0] !== ''\" class=\"files_container\">\n            <div v-for=\"(item, fileIndex) in space.spaceFiles\" :key=\"fileIndex\">\n              <a-button @click=\"downloadFile(spaceIndex, fileIndex)\">点击下载文件 {{fileIndex + 1}} </a-button>\n            </div>\n          </div>\n          <div class=\"like_container\">\n            <LikeOutlined class=\"like\" @click=\"likeSpace(space.spaceId, spaceIndex)\"/>\n            {{ space.likeNum }}\n          </div>\n        </div>\n      </div>\n      <!--查看更多-->\n      <div class=\"btn_container\">\n        <a-button style=\"font-family: 夏风\" type=\"text\" @click=\"getMore\">- 查看更多 -</a-button>\n      </div>\n    </div>\n    <ImgCom/>\n  </div>\n</template>\n\n<style scoped>\n  .space_background{\n    background: linear-gradient(to right bottom, #fdfdfd, #f3f6fc);\n    overflow-y: scroll;\n    overflow-x: hidden;\n  }\n  .space_line{\n    display: flex;\n    align-items: flex-start;\n    justify-content: space-between;\n    margin: 0 52px;\n    height: auto;\n    position: relative;\n  }\n  .space_line .space-line-background{\n    z-index: -1;\n    position: absolute;\n    width: calc(100% + 104px);\n    left: -52px;\n    top: 50%;\n    transform: translateY(-50%);\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    overflow: hidden\n  }\n  .space_line .space-line-background img{\n    position: absolute;\n    object-fit: cover;\n    min-height: 100%;\n    min-width: 100%;\n  }\n  .space_line .space-line-background div{\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    background-color: #E7E1E188;\n    backdrop-filter: blur(4px);\n  }\n  .time_container{\n    width: 128px;\n    text-align: right;\n    line-height: 28px;\n    padding-right: 12px;\n    letter-spacing: 2px;\n    font-family: 清泉;\n    margin-top: 4px;\n    animation: right-fade-in 1s 1;\n  }\n  .content_container{\n    flex: 1;\n    position: relative;\n    border-left: #6767dc 2px solid;\n    min-height: 80px;\n    padding: 12px 0 32px 12px;\n    animation: top-fade-in 1s 1;\n    white-space: pre-line;\n  }\n  .content_container p{\n    padding: 0 0 0 8px;\n  }\n  .imgs_container{\n    display: flex;\n    flex-wrap: wrap;\n  }\n  .imgs_container div{\n    min-width: 200px;\n    min-height: 150px;\n    width: calc(32vw - 100px);\n    height: calc(24vw - 75px);\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    margin: 8px;\n    box-shadow: 0 0 4px #00000011;\n    border-radius: 4px;\n    transition: .4s;\n  }\n  .imgs_container img{\n    min-width: 100%;\n    min-height: 100%;\n    object-fit: cover;\n    cursor: pointer;\n    box-shadow: 2px 2px 8px #00000044;\n  }\n  .imgs_container div:hover{\n    box-shadow: 0 0 8px #00000022;\n    transition: .4s;\n  }\n  .files_container{\n    display: flex;\n    flex-wrap: wrap;\n  }\n  .files_container button{\n    margin: 4px 0 12px 8px;\n  }\n  .like_container{\n    margin: 0 8px 0 8px;\n    text-align: right;\n  }\n  .like{\n    transition: .2s;\n  }\n  .like:active{\n    transition: .2s;\n    transform: scale(1.2);\n  }\n  .btn_container{\n    margin-bottom: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n    background: linear-gradient(to bottom, #f2efef, #fff);\n  }\n\n\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}