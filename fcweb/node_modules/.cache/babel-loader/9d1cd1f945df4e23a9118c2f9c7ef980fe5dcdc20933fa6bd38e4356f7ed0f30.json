{"ast":null,"code":"import { createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-4f0694a5\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"space_background\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h4\", {\n  style: {\n    \"font-family\": \"夏风\"\n  }\n}, \"- 我的空间 -\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  class: \"space_line_container\"\n};\nconst _hoisted_4 = {\n  style: {\n    \"font-family\": \"清泉\"\n  }\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"imgs_container\"\n};\nconst _hoisted_6 = [\"onClick\", \"src\"];\nconst _hoisted_7 = {\n  key: 1,\n  class: \"files_container\"\n};\nconst _hoisted_8 = {\n  class: \"like_container\"\n};\nconst _hoisted_9 = {\n  class: \"btn_container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_button = _resolveComponent(\"a-button\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode($setup[\"HomeOutlined\"], {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.jumphelper.jumpToSelect()),\n    class: \"home_icon\"\n  }), _hoisted_2, _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.spaces, (space, spaceIndex) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: spaceIndex,\n      class: \"space_line\"\n    }, [_createElementVNode(\"h5\", _hoisted_4, _toDisplayString(space.spaceTime), 1 /* TEXT */), _createElementVNode(\"p\", null, _toDisplayString(space.spaceContent), 1 /* TEXT */), space.spaceImgs[0] !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(space.spaceImgs, (item, imgIndex) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: imgIndex\n      }, [_createElementVNode(\"img\", {\n        onClick: $event => $setup.showSpaceImg(item),\n        src: item,\n        alt: \"\"\n      }, null, 8 /* PROPS */, _hoisted_6)]);\n    }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), space.spaceFiles[0] !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(space.spaceFiles, (item, fileIndex) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: fileIndex\n      }, [_createVNode(_component_a_button, {\n        onClick: $event => $setup.downloadFile(spaceIndex, fileIndex)\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"点击下载文件 \" + _toDisplayString(fileIndex + 1), 1 /* TEXT */)]),\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]);\n    }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_8, [_createVNode($setup[\"LikeOutlined\"], {\n      class: \"like\",\n      onClick: $event => $setup.likeSpace(space.spaceId, spaceIndex)\n    }, null, 8 /* PROPS */, [\"onClick\"]), _createTextVNode(\" \" + _toDisplayString(space.likeNum), 1 /* TEXT */)])]);\n  }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\"查看更多\"), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_a_button, {\n    style: {\n      \"font-family\": \"夏风\"\n    },\n    type: \"text\",\n    onClick: $setup.getMore\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"- 查看更多 -\")]),\n    _: 1 /* STABLE */\n  })])]), _createVNode($setup[\"ImgCom\"])]);\n}","map":{"version":3,"names":["class","_createElementVNode","style","key","_createElementBlock","_hoisted_1","_createVNode","$setup","onClick","_cache","$event","jumphelper","jumpToSelect","_hoisted_2","_hoisted_3","_Fragment","_renderList","spaces","space","spaceIndex","_hoisted_4","_toDisplayString","spaceTime","spaceContent","spaceImgs","_hoisted_5","item","imgIndex","showSpaceImg","src","alt","_hoisted_6","_createCommentVNode","spaceFiles","_hoisted_7","fileIndex","_component_a_button","downloadFile","default","_withCtx","_createTextVNode","_","_hoisted_8","likeSpace","spaceId","likeNum","_hoisted_9","type","getMore"],"sources":["/Users/ayden/Desktop/FiveCheersBlog/fcweb/src/pages/myspace/PhoneMySpace.vue"],"sourcesContent":["<script setup>\nimport {\n  HomeOutlined,\n  LikeOutlined\n} from '@ant-design/icons-vue';\nimport {jumphelper} from \"@/js/jumphelper\";\nimport {onMounted, ref} from \"vue\";\nimport {likeSpaceApi, postLog, selectSpaceApi} from \"@/js/apihelper\";\nimport {timeCorrect} from \"@/js/jshelper\";\nimport {message} from \"ant-design-vue\";\nimport {bus} from \"vue3-eventbus\";\nimport ImgCom from \"@/coms/all/ImgCom.vue\";\nonMounted(()=>{\n  getSpace()\n  getLikedData()\n})\nconst currentParams = ref({\n  startIndex: 0,\n  length: 4,\n})\nconst spaces = ref([])\nconst getSpace = ()=>{\n  const getResult = selectSpaceApi(currentParams.value)\n  getResult.then(response=>{\n    for (const tmpSpace of response.data) {\n      tmpSpace.spaceTime = timeCorrect(tmpSpace.spaceTime)\n    }\n    if (response.data.length>0){\n      spaces.value = spaces.value.concat(response.data)\n    }else{\n      message.warn('后面没有了，更早的请看旧版于眉顶部“我的空间”')\n    }\n\n  }).catch(e=>{\n    console.log(e)\n    message.error('未知错误')\n  })\n}\nconst downloadFile = (spaceIndex, fileIndex)=>{\n  const fileUrl = spaces.value[spaceIndex].spaceFiles[fileIndex]\n  window.location.href = fileUrl\n}\nconst likeSpace = (spaceId, spaceIndex)=>{\n  if (beforeLike(spaceId)){\n    const postResult = likeSpaceApi(spaceId)\n    postResult.then(response=>{\n      if (response.data){\n        saveLikedData()\n        message.success('谢谢喜欢:D')\n        postLog('空间点赞，spaceId为'+spaceId)\n        spaces.value[spaceIndex].likeNum += 1\n      }else {\n        message.error('点赞失败')\n      }\n    }).catch(e=>{\n      message.error('未知错误')\n      console.log(e)\n    })\n  }else{\n    message.warn('每天只能给每条说说点10个赞')\n  }\n\n}\nconst getMore = ()=>{\n  currentParams.value.startIndex += currentParams.value.length;\n  getSpace()\n}\n\nconst likedData = ref([])\nconst getLikedData = ()=>{\n  if (localStorage.getItem('likedData')){\n    likedData.value = JSON.parse(localStorage.getItem('likedData'))\n  }else{\n    localStorage.setItem('likedData','[]')\n    likedData.value = JSON.parse(localStorage.getItem('likedData'))\n  }\n}\nconst saveLikedData = ()=>{\n  const likedDataString = JSON.stringify(likedData.value)\n  localStorage.setItem('likedData', likedDataString)\n}\nconst beforeLike = (spaceId)=>{\n  const filteredArray = likedData.value.filter(item => item.spaceId === spaceId);\n  console.log(filteredArray)\n  if (filteredArray.length>0){\n    for (const filteredArrayElement of filteredArray) {\n      if (filteredArrayElement.time === getNowTime() && filteredArrayElement.num >= 10){\n        return false\n      }else if (filteredArrayElement.time !== getNowTime()){\n        filteredArrayElement.time = getNowTime()\n        filteredArrayElement.num = 1\n        return true\n      }else{\n        filteredArrayElement.num += 1\n        return true\n      }\n    }\n  }else{\n    likedData.value.push({\n      spaceId: spaceId,\n      userId: localStorage.getItem('UUID'),\n      time: getNowTime(),\n      num: 1\n    })\n    return true\n  }\n  return false\n}\nconst getNowTime = ()=>{\n  const date = new Date()\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2,'0')\n  const day = String(date.getDate()).padStart(2, '0')\n  const nowTime = `${year}-${month}-${day}`\n  return nowTime\n}\nconst showSpaceImg = (imgUrl)=>{\n   bus.emit('showImg',imgUrl)\n}\n</script>\n\n<template>\n  <div class=\"space_background\">\n    <HomeOutlined @click=\"jumphelper.jumpToSelect()\" class=\"home_icon\"/>\n    <h4 style=\"font-family: 夏风\">- 我的空间 -</h4>\n    <div class=\"space_line_container\">\n      <div v-for=\"(space, spaceIndex) in spaces\" :key=\"spaceIndex\" class=\"space_line\">\n        <h5 style=\"font-family: 清泉\">{{ space.spaceTime }}</h5>\n        <p>{{ space.spaceContent }}</p>\n        <div v-if=\"space.spaceImgs[0] !== ''\" class=\"imgs_container\">\n          <div v-for=\"(item, imgIndex) in space.spaceImgs\" :key=\"imgIndex\">\n            <img @click=\"showSpaceImg(item)\" :src=\"item\" alt=\"\">\n          </div>\n        </div>\n        <div v-if=\"space.spaceFiles[0] !== ''\" class=\"files_container\">\n          <div v-for=\"(item, fileIndex) in space.spaceFiles\" :key=\"fileIndex\">\n            <a-button @click=\"downloadFile(spaceIndex, fileIndex)\">点击下载文件 {{fileIndex + 1}} </a-button>\n          </div>\n        </div>\n        <div class=\"like_container\">\n          <LikeOutlined class=\"like\" @click=\"likeSpace(space.spaceId, spaceIndex)\"/>\n          {{ space.likeNum }}\n        </div>\n      </div>\n      <!--查看更多-->\n      <div class=\"btn_container\">\n        <a-button style=\"font-family: 夏风\" type=\"text\" @click=\"getMore\">- 查看更多 -</a-button>\n      </div>\n    </div>\n    <ImgCom/>\n  </div>\n</template>\n\n<style scoped>\n  .space_background{\n    background-color: #f5f8ff;\n  }\n  .space_background h4{\n    font-weight: bold;\n    letter-spacing: 4px;\n    width: 100%;\n    color: #444;\n    text-align: center;\n    height: 46px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: top-fade-in .8s 1;\n  }\n  .space_line_container{\n    position: absolute;\n    top: 46px;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #f6f6f6;\n    overflow-y: scroll;\n    overflow-x: hidden;\n    animation: jump-out-1 .6s 1;\n  }\n  .space_line{\n    padding: 16px 8px;\n    word-break: break-all;\n    background-color: #ffffff;\n    margin-bottom: 8px;\n  }\n  .space_line p{\n    white-space: pre-line;\n    letter-spacing: 2px;\n  }\n  .imgs_container{\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n  }\n  .imgs_container div{\n    width: calc(50vw - 24px);\n    height: calc(50vw - 24px);\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    margin: 8px;\n    box-shadow: 0 0 4px #00000011;\n    border-radius: 4px;\n  }\n  .imgs_container img{\n    min-width: 100%;\n    min-height: 100%;\n    object-fit: cover;\n  }\n  .files_container div{\n    margin: 8px 0;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n  .space_line_container::-webkit-scrollbar {\n    width : 0;\n    height: 1px;\n  }\n  .like_container{\n    margin: 12px 4px 0 4px;\n    text-align: right;\n  }\n  .like{\n    transition: .2s;\n  }\n  .like:active{\n    transition: .2s;\n    transform: scale(1.2);\n  }\n  .btn_container{\n    margin-bottom: 8px;\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n  }\n\n\n</style>"],"mappings":";;;EA0HOA,KAAK,EAAC;AAAkB;gEAE3BC,mBAAA,CAAyC;EAArCC,KAAuB,EAAvB;IAAA;EAAA;AAAuB,GAAC,UAAQ;;EAC/BF,KAAK,EAAC;AAAsB;;EAEzBE,KAAuB,EAAvB;IAAA;EAAA;AAAuB;;EA/HnCC,GAAA;EAiI8CH,KAAK,EAAC;;mBAjIpD;;EAAAG,GAAA;EAsI+CH,KAAK,EAAC;;;EAKxCA,KAAK,EAAC;AAAgB;;EAMxBA,KAAK,EAAC;AAAe;;;uBAvB9BI,mBAAA,CA4BM,OA5BNC,UA4BM,GA3BJC,YAAA,CAAoEC,MAAA;IAArDC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEH,MAAA,CAAAI,UAAU,CAACC,YAAY;IAAIZ,KAAK,EAAC;MACvDa,UAAyC,EACzCZ,mBAAA,CAuBM,OAvBNa,UAuBM,I,kBAtBJV,mBAAA,CAiBMW,SAAA,QA/IZC,WAAA,CA8HyCT,MAAA,CAAAU,MAAM,EA9H/C,CA8HmBC,KAAK,EAAEC,UAAU;yBAA9Bf,mBAAA,CAiBM;MAjBsCD,GAAG,EAAEgB,UAAU;MAAEnB,KAAK,EAAC;QACjEC,mBAAA,CAAsD,MAAtDmB,UAAsD,EAAAC,gBAAA,CAAvBH,KAAK,CAACI,SAAS,kBAC9CrB,mBAAA,CAA+B,WAAAoB,gBAAA,CAAzBH,KAAK,CAACK,YAAY,kBACbL,KAAK,CAACM,SAAS,c,cAA1BpB,mBAAA,CAIM,OAJNqB,UAIM,I,kBAHJrB,mBAAA,CAEMW,SAAA,QApIhBC,WAAA,CAkI0CE,KAAK,CAACM,SAAS,EAlIzD,CAkIuBE,IAAI,EAAEC,QAAQ;2BAA3BvB,mBAAA,CAEM;QAF4CD,GAAG,EAAEwB;MAAQ,IAC7D1B,mBAAA,CAAoD;QAA9CO,OAAK,EAAAE,MAAA,IAAEH,MAAA,CAAAqB,YAAY,CAACF,IAAI;QAAIG,GAAG,EAAEH,IAAI;QAAEI,GAAG,EAAC;8BAnI7DC,UAAA,E;wCAAAC,mBAAA,gBAsImBd,KAAK,CAACe,UAAU,c,cAA3B7B,mBAAA,CAIM,OAJN8B,UAIM,I,kBAHJ9B,mBAAA,CAEMW,SAAA,QAzIhBC,WAAA,CAuI2CE,KAAK,CAACe,UAAU,EAvI3D,CAuIuBP,IAAI,EAAES,SAAS;2BAA5B/B,mBAAA,CAEM;QAF8CD,GAAG,EAAEgC;MAAS,IAChE7B,YAAA,CAA2F8B,mBAAA;QAAhF5B,OAAK,EAAAE,MAAA,IAAEH,MAAA,CAAA8B,YAAY,CAAClB,UAAU,EAAEgB,SAAS;;QAxIhEG,OAAA,EAAAC,QAAA,CAwImE,MAAO,CAxI1EC,gBAAA,CAwImE,SAAO,GAAAnB,gBAAA,CAAEc,SAAS,qB;QAxIrFM,CAAA;;wCAAAT,mBAAA,gBA2IQ/B,mBAAA,CAGM,OAHNyC,UAGM,GAFJpC,YAAA,CAA0EC,MAAA;MAA5DP,KAAK,EAAC,MAAM;MAAEQ,OAAK,EAAAE,MAAA,IAAEH,MAAA,CAAAoC,SAAS,CAACzB,KAAK,CAAC0B,OAAO,EAAEzB,UAAU;0CA5IhFqB,gBAAA,CA4IoF,GAC1E,GAAAnB,gBAAA,CAAGH,KAAK,CAAC2B,OAAO,iB;kCAGpBb,mBAAA,QAAW,EACX/B,mBAAA,CAEM,OAFN6C,UAEM,GADJxC,YAAA,CAAkF8B,mBAAA;IAAxElC,KAAuB,EAAvB;MAAA;IAAA,CAAuB;IAAC6C,IAAI,EAAC,MAAM;IAAEvC,OAAK,EAAED,MAAA,CAAAyC;;IAlJ9DV,OAAA,EAAAC,QAAA,CAkJuE,MAAQ,CAlJ/EC,gBAAA,CAkJuE,UAAQ,E;IAlJ/EC,CAAA;UAqJInC,YAAA,CAASC,MAAA,Y"},"metadata":{},"sourceType":"module","externalDependencies":[]}