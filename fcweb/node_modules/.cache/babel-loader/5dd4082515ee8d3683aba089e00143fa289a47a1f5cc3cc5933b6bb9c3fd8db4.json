{"ast":null,"code":"import { UploadOutlined } from \"@ant-design/icons-vue\";\nimport { message } from \"ant-design-vue\";\nimport { onMounted, ref } from \"vue\";\nimport { bus } from \"vue3-eventbus\";\nimport { insertNewMyGit } from \"@/js/apihelper\";\nexport default {\n  __name: 'NewGitCom',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    onMounted(() => {\n      bus.on('newVideoShow', () => {\n        newVideoShow.value = true;\n      });\n    });\n    const newVideoHide = () => {\n      newVideoShow.value = false;\n      bus.emit('setCardShowingFalse');\n    };\n    const newVideoShow = ref(false);\n    const newMyGit = ref({\n      gitContent: null,\n      gitVideo: null,\n      gitUrl: null,\n      runUrl: null\n    });\n    const handleUploadChange = info => {\n      if (info.file.status === 'done') {\n        message.success(`文件上传成功`);\n        newMyGit.value.gitVideo = info.file.response;\n      } else if (info.file.status === 'error') {\n        message.error(`${info.file.name} 文件上传失败`);\n      }\n    };\n    const insertNewVideoSure = () => {\n      if (newMyGit.value.gitVideo && newMyGit.value.gitContent && newMyGit.value.gitUrl) {\n        const postResult = insertNewMyGit(newMyGit.value);\n        postResult.then(response => {\n          if (response.data) {\n            message.success('添加成功');\n            newVideoHide();\n          } else {\n            message.error('添加失败');\n            console.log(response);\n          }\n        }).catch(e => {\n          console.log(e);\n          message.error('添加失败');\n        });\n      } else {\n        message.warn('请先上传文件并填入简介和项目地址');\n      }\n    };\n    const __returned__ = {\n      newVideoHide,\n      newVideoShow,\n      newMyGit,\n      handleUploadChange,\n      insertNewVideoSure,\n      get UploadOutlined() {\n        return UploadOutlined;\n      },\n      get message() {\n        return message;\n      },\n      onMounted,\n      ref,\n      get bus() {\n        return bus;\n      },\n      get insertNewMyGit() {\n        return insertNewMyGit;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["UploadOutlined","message","onMounted","ref","bus","insertNewMyGit","on","newVideoShow","value","newVideoHide","emit","newMyGit","gitContent","gitVideo","gitUrl","runUrl","handleUploadChange","info","file","status","success","response","error","name","insertNewVideoSure","postResult","then","data","console","log","catch","e","warn"],"sources":["/Users/ayden/Desktop/FiveCheersBlog/fcweb/src/coms/mygit/NewGitCom.vue"],"sourcesContent":["<script setup>\n\nimport {UploadOutlined} from \"@ant-design/icons-vue\";\nimport {message} from \"ant-design-vue\";\nimport {onMounted, ref} from \"vue\";\nimport {bus} from \"vue3-eventbus\";\nimport {insertNewMyGit} from \"@/js/apihelper\";\n\nonMounted(()=>{\n  bus.on('newVideoShow', ()=>{\n    newVideoShow.value = true;\n  })\n})\nconst newVideoHide = ()=>{\n  newVideoShow.value = false\n  bus.emit('setCardShowingFalse')\n}\nconst newVideoShow = ref(false)\nconst newMyGit = ref({\n  gitContent:null,\n  gitVideo: null,\n  gitUrl:null,\n  runUrl:null\n})\nconst handleUploadChange = (info)=>{\n  if (info.file.status === 'done') {\n    message.success(`文件上传成功`);\n    newMyGit.value.gitVideo = info.file.response\n  } else if (info.file.status === 'error') {\n    message.error(`${info.file.name} 文件上传失败`);\n  }\n}\nconst insertNewVideoSure = ()=>{\n  if (newMyGit.value.gitVideo && newMyGit.value.gitContent && newMyGit.value.gitUrl){\n    const postResult = insertNewMyGit(newMyGit.value)\n    postResult.then(response=>{\n      if (response.data){\n        message.success('添加成功')\n        newVideoHide()\n      }else{\n        message.error('添加失败')\n        console.log(response)\n      }\n    }).catch(e=>{\n      console.log(e)\n      message.error('添加失败')\n    })\n  }else {\n    message.warn('请先上传文件并填入简介和项目地址')\n  }\n}\n\n</script>\n\n<template>\n  <transition name=\"fade\">\n    <div v-if=\"newVideoShow\" class=\"new-video-container\">\n      <div class=\"card-container\">\n        <a-upload\n            action=\"https://www.yym-free.com/wz/file/defaultUpLoadFile\"\n            @change=\"handleUploadChange\">\n          <a-button style=\"margin-top: 8px\">\n            <upload-outlined></upload-outlined>\n            上传单个视频\n          </a-button>\n        </a-upload>\n        <a-textarea placeholder=\"输入简述\" :auto-size=\"{ minRows: 3, maxRows: 5 }\" v-model:value=\"newMyGit.gitContent\"/>\n        <a-input placeholder=\"输入Git地址\" v-model:value=\"newMyGit.gitUrl\"/>\n        <a-input placeholder=\"输入运行地址\" v-model:value=\"newMyGit.runUrl\"/>\n        <div class=\"btns-line\">\n          <a-button type=\"primary\" @click=\"insertNewVideoSure\">确定</a-button>\n          <a-button @click=\"newVideoHide\">取消</a-button>\n        </div>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<style scoped>\n.new-video-container{\n  position: fixed;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #00000011;\n  backdrop-filter: blur(8px);\n}\n.card-container{\n  position: fixed;\n  top: 60px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 320px;\n  height: 400px;\n  box-shadow: 0 0 12px #00000044;\n  background-color: #ffffff;\n  backdrop-filter: blur(8px);\n  border-radius: 8px;\n  animation: topDropAni .8s 1;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  flex-direction: column;\n  padding: 28px 20px 20px 20px;\n}\n.btns-line{\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n</style>"],"mappings":"AAEA,SAAQA,cAAc,QAAO,uBAAuB;AACpD,SAAQC,OAAO,QAAO,gBAAgB;AACtC,SAAQC,SAAS,EAAEC,GAAG,QAAO,KAAK;AAClC,SAAQC,GAAG,QAAO,eAAe;AACjC,SAAQC,cAAc,QAAO,gBAAgB;;;;;;;IAE7CH,SAAS,CAAC,MAAI;MACZE,GAAG,CAACE,EAAE,CAAC,cAAc,EAAE,MAAI;QACzBC,YAAY,CAACC,KAAK,GAAG,IAAI;MAC3B,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,MAAMC,YAAY,GAAGA,CAAA,KAAI;MACvBF,YAAY,CAACC,KAAK,GAAG,KAAK;MAC1BJ,GAAG,CAACM,IAAI,CAAC,qBAAqB,CAAC;IACjC,CAAC;IACD,MAAMH,YAAY,GAAGJ,GAAG,CAAC,KAAK,CAAC;IAC/B,MAAMQ,QAAQ,GAAGR,GAAG,CAAC;MACnBS,UAAU,EAAC,IAAI;MACfC,QAAQ,EAAE,IAAI;MACdC,MAAM,EAAC,IAAI;MACXC,MAAM,EAAC;IACT,CAAC,CAAC;IACF,MAAMC,kBAAkB,GAAIC,IAAI,IAAG;MACjC,IAAIA,IAAI,CAACC,IAAI,CAACC,MAAM,KAAK,MAAM,EAAE;QAC/BlB,OAAO,CAACmB,OAAO,CAAE,QAAO,CAAC;QACzBT,QAAQ,CAACH,KAAK,CAACK,QAAQ,GAAGI,IAAI,CAACC,IAAI,CAACG,QAAQ;MAC9C,CAAC,MAAM,IAAIJ,IAAI,CAACC,IAAI,CAACC,MAAM,KAAK,OAAO,EAAE;QACvClB,OAAO,CAACqB,KAAK,CAAE,GAAEL,IAAI,CAACC,IAAI,CAACK,IAAK,SAAQ,CAAC;MAC3C;IACF,CAAC;IACD,MAAMC,kBAAkB,GAAGA,CAAA,KAAI;MAC7B,IAAIb,QAAQ,CAACH,KAAK,CAACK,QAAQ,IAAIF,QAAQ,CAACH,KAAK,CAACI,UAAU,IAAID,QAAQ,CAACH,KAAK,CAACM,MAAM,EAAC;QAChF,MAAMW,UAAU,GAAGpB,cAAc,CAACM,QAAQ,CAACH,KAAK,CAAC;QACjDiB,UAAU,CAACC,IAAI,CAACL,QAAQ,IAAE;UACxB,IAAIA,QAAQ,CAACM,IAAI,EAAC;YAChB1B,OAAO,CAACmB,OAAO,CAAC,MAAM,CAAC;YACvBX,YAAY,CAAC,CAAC;UAChB,CAAC,MAAI;YACHR,OAAO,CAACqB,KAAK,CAAC,MAAM,CAAC;YACrBM,OAAO,CAACC,GAAG,CAACR,QAAQ,CAAC;UACvB;QACF,CAAC,CAAC,CAACS,KAAK,CAACC,CAAC,IAAE;UACVH,OAAO,CAACC,GAAG,CAACE,CAAC,CAAC;UACd9B,OAAO,CAACqB,KAAK,CAAC,MAAM,CAAC;QACvB,CAAC,CAAC;MACJ,CAAC,MAAK;QACJrB,OAAO,CAAC+B,IAAI,CAAC,kBAAkB,CAAC;MAClC;IACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}