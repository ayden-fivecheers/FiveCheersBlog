{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { HomeOutlined, PlusOutlined } from '@ant-design/icons-vue';\nimport { jumphelper } from \"@/js/jumphelper\";\nimport { bus } from \"vue3-eventbus\";\nimport { onMounted, ref } from \"vue\";\nimport { deleteMyGit, selectMyGit } from \"@/js/apihelper\";\nimport { message } from \"ant-design-vue\";\nimport { timeCorrect } from \"@/js/jshelper\";\nimport NewGitCom from \"@/coms/mygit/NewGitCom.vue\";\nimport DefaultBackground from \"@/coms/all/DefaultBackground.vue\";\nexport default {\n  __name: 'DesktopMyGit',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const newVideoShow = () => {\n      bus.emit('newVideoShow');\n      cardShowing.value = true;\n    };\n    const videoList = ref([]);\n    const currentProps = ref({\n      firstIndex: 0,\n      length: 3\n    });\n    const pushVideos = async () => {\n      try {\n        let scrollElem = scrollDiv.value;\n        var currentTop = scrollElem.scrollTop;\n        const getResults = selectMyGit(currentProps.value);\n        const response = await getResults;\n        if (response.data.length > 0) {\n          console.log(response);\n          for (const datum of response.data) {\n            const tmp = datum;\n            tmp.time = timeCorrect(datum.time);\n            videoList.value.push(tmp);\n          }\n          currentProps.value.firstIndex += currentProps.value.length;\n\n          // 等待数据push完成后再滚动\n          await new Promise(resolve => setTimeout(resolve, 100));\n          scrollElem.scrollTo({\n            top: currentTop,\n            behavior: 'auto'\n          });\n        } else {\n          message.warn('后面没有了');\n        }\n      } catch (error) {\n        console.log(error);\n        message.error('查询视频失败');\n      }\n    };\n    onMounted(() => {\n      if (localStorage.getItem('managerSecret') && localStorage.getItem('managerSecret') === 'nzt100years') {\n        isManager.value = true;\n      }\n      pushVideos();\n      bus.on('setCardShowingFalse', () => {\n        window.location.reload();\n      });\n    });\n    const deleteMG = gitId => {\n      const postResult = deleteMyGit(gitId);\n      postResult.then(response => {\n        if (response.data) {\n          message.success('删除成功');\n          videoList.value = videoList.value.filter(item => item.gitId !== gitId);\n        } else {\n          message.error('删除失败');\n          console.log(response);\n        }\n      }).catch(e => {\n        message.error('删除失败');\n        console.log(e);\n      });\n    };\n    const getOptions = videoUrl => {\n      return {\n        width: \"100%\",\n        //播放器宽度\n        height: \"auto\",\n        //播放器高度\n        color: \"#409eff\",\n        //主题色\n        title: \"\",\n        //视频名称\n        src: videoUrl,\n        //视频源\n        muted: false,\n        //静音\n        webFullScreen: false,\n        speedRate: [\"0.75\", \"1.0\", \"1.25\", \"1.5\", \"2.0\"],\n        //播放倍速\n        autoPlay: false,\n        //自动播放\n        loop: false,\n        //循环播放\n        mirror: false,\n        //镜像画面\n        ligthOff: false,\n        //关灯模式\n        volume: 0.3,\n        //默认音量大小\n        control: true,\n        //是否显示控制\n        controlBtns: [\"audioTrack\", \"quality\", \"speedRate\", \"volume\", \"setting\", \"pip\", \"pageFullScreen\", \"fullScreen\"] //显示所有按钮,\n      };\n    };\n    /*const downloadFile = (fileUrl)=>{\n      window.location.href = fileUrl\n    }*/\n    const cardShowing = ref(false);\n    const isManager = ref(false);\n    const scrollDiv = ref();\n    const __returned__ = {\n      newVideoShow,\n      videoList,\n      currentProps,\n      pushVideos,\n      deleteMG,\n      getOptions,\n      cardShowing,\n      isManager,\n      scrollDiv,\n      get HomeOutlined() {\n        return HomeOutlined;\n      },\n      get PlusOutlined() {\n        return PlusOutlined;\n      },\n      get jumphelper() {\n        return jumphelper;\n      },\n      get bus() {\n        return bus;\n      },\n      onMounted,\n      ref,\n      get deleteMyGit() {\n        return deleteMyGit;\n      },\n      get selectMyGit() {\n        return selectMyGit;\n      },\n      get message() {\n        return message;\n      },\n      get timeCorrect() {\n        return timeCorrect;\n      },\n      NewGitCom,\n      DefaultBackground\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["HomeOutlined","PlusOutlined","jumphelper","bus","onMounted","ref","deleteMyGit","selectMyGit","message","timeCorrect","NewGitCom","DefaultBackground","newVideoShow","emit","cardShowing","value","videoList","currentProps","firstIndex","length","pushVideos","scrollElem","scrollDiv","currentTop","scrollTop","getResults","response","data","console","log","datum","tmp","time","push","Promise","resolve","setTimeout","scrollTo","top","behavior","warn","error","localStorage","getItem","isManager","on","window","location","reload","deleteMG","gitId","postResult","then","success","filter","item","catch","e","getOptions","videoUrl","width","height","color","title","src","muted","webFullScreen","speedRate","autoPlay","loop","mirror","ligthOff","volume","control","controlBtns"],"sources":["/Users/ayden/Desktop/FiveCheersBlog/fcweb/src/pages/mygit/DesktopMyGit.vue"],"sourcesContent":["<script setup>\nimport {\n  HomeOutlined,\n  PlusOutlined\n} from '@ant-design/icons-vue';\nimport {jumphelper} from \"@/js/jumphelper\";\nimport {bus} from \"vue3-eventbus\";\nimport {onMounted, ref} from \"vue\";\nimport {deleteMyGit, selectMyGit} from \"@/js/apihelper\";\nimport {message} from \"ant-design-vue\";\nimport {timeCorrect} from \"@/js/jshelper\";\nimport NewGitCom from \"@/coms/mygit/NewGitCom.vue\";\nimport DefaultBackground from \"@/coms/all/DefaultBackground.vue\";\n\nconst newVideoShow = ()=>{\n  bus.emit('newVideoShow')\n  cardShowing.value = true\n}\nconst videoList = ref([])\nconst currentProps = ref({\n  firstIndex: 0,\n  length: 3\n})\nconst pushVideos = async () => {\n  try {\n    let scrollElem = scrollDiv.value;\n    var currentTop = scrollElem.scrollTop;\n    const getResults = selectMyGit(currentProps.value);\n    const response = await getResults;\n    if (response.data.length > 0) {\n      console.log(response);\n      for (const datum of response.data) {\n        const tmp = datum;\n        tmp.time = timeCorrect(datum.time);\n        videoList.value.push(tmp);\n      }\n      currentProps.value.firstIndex += currentProps.value.length;\n\n      // 等待数据push完成后再滚动\n      await new Promise(resolve => setTimeout(resolve, 100));\n      scrollElem.scrollTo({ top: currentTop, behavior: 'auto' });\n    } else {\n      message.warn('后面没有了');\n    }\n  } catch (error) {\n    console.log(error);\n    message.error('查询视频失败');\n  }\n};\n\nonMounted(()=>{\n  if (localStorage.getItem('managerSecret') && localStorage.getItem('managerSecret') === 'nzt100years'){\n    isManager.value = true\n  }\n  pushVideos()\n  bus.on('setCardShowingFalse',()=>{\n    window.location.reload();\n  })\n})\nconst deleteMG = (gitId)=>{\n  const postResult = deleteMyGit(gitId)\n  postResult.then(response=>{\n    if (response.data){\n      message.success('删除成功')\n      videoList.value = videoList.value.filter(item => item.gitId !== gitId)\n    }else{\n      message.error('删除失败')\n      console.log(response)\n    }\n  }).catch(e=>{\n    message.error('删除失败')\n    console.log(e)\n  })\n}\nconst getOptions = (videoUrl)=>{\n  return {\n    width: \"100%\", //播放器宽度\n    height: \"auto\", //播放器高度\n    color: \"#409eff\", //主题色\n    title: \"\", //视频名称\n    src: videoUrl, //视频源\n    muted: false, //静音\n    webFullScreen: false,\n    speedRate: [\"0.75\", \"1.0\", \"1.25\", \"1.5\", \"2.0\"], //播放倍速\n    autoPlay: false, //自动播放\n    loop: false, //循环播放\n    mirror: false, //镜像画面\n    ligthOff: false, //关灯模式\n    volume: 0.3, //默认音量大小\n    control: true, //是否显示控制\n    controlBtns: [\n      \"audioTrack\",\n      \"quality\",\n      \"speedRate\",\n      \"volume\",\n      \"setting\",\n      \"pip\",\n      \"pageFullScreen\",\n      \"fullScreen\",\n    ], //显示所有按钮,\n  }\n}\n/*const downloadFile = (fileUrl)=>{\n  window.location.href = fileUrl\n}*/\nconst cardShowing = ref(false)\nconst isManager = ref(false)\nconst scrollDiv = ref()\n\n</script>\n\n<template>\n  <div class=\"videos-background\">\n    <HomeOutlined style=\"color: #fff\" @click=\"jumphelper.jumpToSelect()\" class=\"home_icon\"/>\n    <h4>- 我的开源 -</h4>\n    <DefaultBackground/>\n    <div ref=\"scrollDiv\" class=\"scroll-container\">\n      <div v-for=\"(item, index) in videoList\" :key=\"index\" class=\"video-line\">\n        <div class=\"left-container\">\n          <vue3VideoPlay\n              v-if=\"!cardShowing\"\n              v-bind=\"getOptions(item.gitVideo)\"\n          />\n        </div>\n        <div class=\"right-container\">\n          <h5 style=\"font-family: 清泉\">{{ item.time }}</h5>\n          <p>{{ item.gitContent }}</p>\n          <div class=\"a-container\">\n            <a v-if=\"item.gitUrl\" :href=\"item.gitUrl\">项目地址</a>\n            <a v-if=\"item.runUrl\" :href=\"item.runUrl\">运行地址</a>\n          </div>\n          <h5 class=\"delete-btn\" @click=\"deleteMG(item.gitId)\" v-if=\"isManager\">删除</h5>\n        </div>\n      </div>\n      <a-button style=\"color: #fff; font-family: 夏风;\" type=\"text\" @click=\"pushVideos\">- 更多 -</a-button>\n    </div>\n    <div @click=\"newVideoShow\" v-if=\"!cardShowing && isManager\" class=\"add-container\">\n      <PlusOutlined />\n    </div>\n    <NewGitCom/>\n  </div>\n</template>\n\n<style scoped>\n.videos-background{\n  background-color: transparent;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n}\n.videos-background h4{\n  font-weight: bold;\n  letter-spacing: 4px;\n  width: 100%;\n  color: #fff;\n  z-index: 9;\n  text-align: center;\n  height: 42px;\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  animation: right-fade-in .8s 1;\n  font-family: 夏风;\n}\n.scroll-container{\n  flex: 1;\n  width: 100%;\n  background-color: #f6f6f6;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.add-container{\n  position: fixed;\n  right: 16px;\n  bottom: 48px;\n  width: 48px;\n  height: 48px;\n  background-color: #f5f8ff;\n  border: 1px solid #5471c088;\n  border-radius: 24px;\n  font-size: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #5471c0aa;\n  cursor: pointer;\n  z-index: 999;\n}\n.video-line{\n  padding: 8px 8px 12px 8px;\n  background: #ffffffaa;\n  border-radius: 8px;\n  margin-bottom: 12px;\n  position: relative;\n  margin-left: 12px;\n  white-space: pre-line;\n  display: flex;\n  justify-content: space-around;\n  backdrop-filter: blur(4px);\n}\n.left-container{\n  flex: 1;\n  padding: 12px;\n}\n.right-container{\n  width: 360px;\n  padding: 12px;\n}\n.delete-btn{\n  position: absolute;\n  right: 8px;\n  top: 8px;\n  text-decoration: underline;\n  color: #666;\n  cursor: pointer;\n}\n.a-container{\n  margin: -8px 0 8px;\n  font-family: 夏风;\n}\n.a-container a{\n  margin-right: 12px;\n  color: #5471c0;\n}\n.a-container a:visited{\n  color: #272396;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}